## HTTP

### 一、版本
1. HTTP/0.9
2. HTTP/1.0
3. HTTP/1.1  （目前普遍应用）
4. HTTP/2 （逐步迁移）

### 二、在TCP/IP协议栈中的位置
* 应用层
* HTTP默认端口：80； HTTPS默认端口：443

### 三、安全性
* HTTP：明文传输不安全
* HTTPS：添加TLS、SSL进行加密传输
* HTTP2：默认开启加密，协议展示位https

### 四、工作过程
一次HTTP操作即一个事务，分为四步：
1. 客户机与服务器需要建立连接。例如单击某个超级链接，HTTP的工作开始
2. 建立连接后，客户机发送一个请求给服务器，请求方式的格式为：统一资源标识符(URL)、协议版本号，后边是MIME信息包括请求修饰符、客户机信息和可能的内容
3. 服务器接到请求后，给予相应的响应信息，其格式为一个状态行，包括信息的协议版本号、一个成功或错误的代码，后边是MIME信息，包括服务器信息、实体信息和可能的内容
4. 客户端接收服务器所返回的信息通过浏览器显示在用户的显示屏上，然后客户机与服务器断开连接

如果在以上过程中的某一步出现错误，那么产生错误的信息将返回到客户端，有显示屏输出。对于用户来说，这些过程是由HTTP自己完成的，用户只要用鼠标点击，等待信息显示就可以了

### 五、请求与相应
* HTTP请求组成：请求行、消息报头、请求正文。 
* HTTP响应组成：状态行、消息报头、响应正文。 
* 请求行组成：以一个方法符号开头，后面跟着请求的URI和协议的版本。 
* 状态行组成：服务器HTTP协议的版本，服务器发回的响应状态代码和状
态代码的文本描述。

#### 请求方法
* GET： 请求获取Request-URI所标识的资源 
* POST： 在Request-URI所标识的资源后附加新的数据 
* HEAD： 请求获取由Request-URI所标识的资源的响应消息报头 
* PUT： 请求服务器存储一个资源，并用Request-URI作为其标识 
* DELETE： 请求服务器删除Request-URI所标识的资源 
* TRACE： 请求服务器回送收到的请求信息，主要用于测试或诊断 
* CONNECT：HTTP/1.1协议中预留给能够将连接改为管道方式的代理服务器。 
* OPTIONS： 请求查询服务器的性能，或者查询与资源相关的选项和需求

#### 响应状态码
* 1xx：指示信息--表示请求已接收，继续处理 
* 2xx：成功--表示请求已被成功接收、理解、接受 
* 3xx：重定向--要完成请求必须进行更进一步的操作 
* 4xx：客户端错误--请求有语法错误或请求无法实现 
* 5xx：服务器端错误--服务器未能实现合法的请求

#### 常用请求报头
* Accept 请求报头域用于指定客户端接受哪些类型的信息。eg：Accept:image/gif 、 Accept:text/html。
    * Accept-Charset 请求报头域用于指定客户端接受的字符集。
    * Accept-Encoding:Accept-Encoding请求报头域类似于Accept，但它是用于指定可接受的内容编码。 
    * Accept-Language请求报头域类似于Accept，但是它是用于指定一种自然语言。 
* Authorization 请求报头域主要用于证明客户端有权查看某个资源。当浏览器访问一个页面时，如果收到服
务器的响应代码为401（未授权），可以发送一个包含Authorization请求报头域的请求，要求服务器对其进
行验证。 
* Host 请求报头域主要用于指定被请求资源的Internet主机和端口号，它通常从HTTP URL中提取出来的，发
送请求时，该报头域是必需的。 
* User-Agent 请求报头域允许客户端将它的操作系统、浏览器和其它属性告诉服务器。

#### 常用响应报头
* Location响应报头域用于重定向接受者到一个新的位置。Location响应报头域常用在更换域名的时候。 
* Server响应报头域包含了服务器用来处理请求的软件信息。与User-Agent请求报头域是相对应的。 
* WWW-Authenticate响应报头域必须被包含在401（未授权的）响应消息中，客户端收到401响应消息时候，并发送Authorization报头域请求服务器对其进行验证时，服务端响应报头就包含该报头域。


#### 常用实体报头
实体报头： 请求和响应消息都可以传送一个实体。一个实体由实体报头域和实体正文组成，但并不是说实体报头域和实体正文要在一起发送，可以只发送实体报头域。实体报头定义了关于实体正文（eg：有无实体正文）和请求所标识的资源的元信息。

* Content-Encoding 实体报头域被用作媒体类型的修饰符，它的值指示了已经被应用到实体正文的附加内容的编码，因而要获得Content-Type报头域中所引用的媒体类型，必须采用相应的解码机制。 
* Content-Language 实体报头域描述了资源所用的自然语言。 
* Content-Length 实体报头域用于指明实体正文的长度，以字节方式存储的十进制数字来表示。 
* Content-Type 实体报头域用语指明发送给接收者的实体正文的媒体类型。 
* Last-Modified 实体报头域用于指示资源的最后修改日期和时间。 
* Expires 实体报头域给出响应过期的日期和时间。

#### cookies与session

* Cookie：保存在客户端的小段文本，随客户端的每一个请求发送该url下的所有cookies到服务器端。
    * 服务器在响应消息中用Set-Cookie头将Cookie的内容回送给客户端，客户端在新的请求中将相同的内容携带在Cookie头中发送给服务器。从而实现会话的保持。
    
* Session：保存在服务器端，通过唯一的值sessionID来区别每一个用户。SessionID随每个连接请求发送到服务器，服务器根据sessionID来识别客户端，再通过session 的key获取session值。
    * token：用户量大了，服务器就要存储大量的sessionID，于是使用一个用户信息的加密串存储在客户端
### 六、缓存
* 强制缓存：服务器通知浏览器一个缓存时间，在缓存时间内，下次请求，直接用缓存，不在时间内，执行比较缓存策略。
* 对比缓存：将缓存信息中的Etag和Last-Modified通过请求发送给服务器，由服务器校验，返回304状态码时，浏览器直接使用缓存。
    * Etag/If-None-Match策略
    * Last-Modified/If-Modified-Since策略

### 七、HTTPS
* HTTPS协议的安全性由SSL协议实现，当前使用的TLS协议1.2版本包含了四个核心子协议：握手协议、密钥配置切换协议、应用数据协议及报警协议。 
* 数字证书：数字证书是互联网通信中标识双方身份信息的数字文件，由CA签发。 
* CA：CA（certification authority）是数字证书的签发机构。作为权威机构，其审核申请者身份后签发数字证书，这样我们只需要校验数字证书即可确定对方的真实身份。 
* HTTPS协议、SSL协议、TLS协议、握手协议的关系 
    * HTTPS是Hypertext Transfer Protocol over Secure Socket Layer的缩写，即HTTP over SSL，可理解为基于SSL的HTTP协议。HTTPS协议安全是由SSL协议实现的。 
    * SSL协议是一种记录协议，扩展性良好，可以很方便的添加子协议，而握手协议便是SSL协议的一个子协议。 
    * TLS协议是SSL协议的后续版本，本文中涉及的SSL协议默认是TLS协议1.2版本。

### 八、HTTP2
* 使用二进制格式传输，更高效、更紧凑。 
* 对报头压缩，降低开销。 
* 多路复用，一个网络连接实现并行请求。 
* 服务器主动推送，减少请求的延迟 
* 默认使用加密

#### HTTP2伪头字段
* 伪头部字段是http2内置的几个特殊的以”:”开始的key，用于替代HTTP/1.x中请求行/响应行中的信息，比如请求方法，响应状态码等 
* :method 目标URL模式部分（请求） 
* :scheme 目标URL模式部分（请求） 
* :authority 目标RUL认证部分（请求） 
* :path 目标URL的路径和查询部分（绝对路径产生式和一个跟着"?"字符的查询产生式）（请求） 
* :status 响应头中的HTTP状态码部分（响应）

### 九、HTTP3 传输层上的改进 是一种全新的协议
* HTTP-over-QUIC被更名为HTTP 3 
* QUIC协议是什么（Quick UDP Internet Connection） 
* HTTP 3与HTTP 1.1和HTTP 2没有直接的关系 
* HTTP 3不是http2的扩展 
* HTTP 3将会是一个全新的WEB协议 
* HTTP 3目前处于制订和测试阶段