# 协议
互联网，实际上是一套理念和协议组成的体系架构。在网络中，一个文件通常会被拆分为很多数据包来进行传输。

## OSI参考模型
ISO组织提出的开放系统互连参考模型。该体系结构标准定义了网络互联的七层框架，包括物理层、数据链路层、网络层、传输层、会话层、表示层和应用层。


OSI中的层 | 功能 | TCP/IP协议族
-|-|-
应用层 | 文件传输，电子邮件，文件服务，虚拟终端 |TFTP，HTTP，SNMP，FTP，SMTP，DNS，Telnet 等等  Websocket
表示层 | 数据格式化，代码转换，数据加密 | 没有协议
会话层 | 解除或建立与别的接点的联系 | 没有协议
传输层 | 提供端对端的接口 | TCP，UDP
网络层 | 为数据包选择路由 |IP，ICMP，OSPF，EIGRP，IGMP
数据链路层 | 传输有地址的帧以及错误检测功能 SLIP，CSLIP，PPP，MTU
物理层 | 以二进制数据形式在物理媒体上传输数据 | ISO2110，IEEE802，IEEE802.2

## IP
网际协议（Internet Protocol），把数据包送达目的主机。

## UDP
用户数据包协议（User Datagram Protocol），通过*端口号*把数据包送达应用程序。  
虽说 UDP 不能保证数据可靠性，但是传输速度却非常快，所以 UDP 会应用在一些关注速度、但不那么严格要求数据完整性的领域，如在线视频、互动游戏等。

## [TCP](https://zh.wikipedia.org/wiki/%E4%BC%A0%E8%BE%93%E6%8E%A7%E5%88%B6%E5%8D%8F%E8%AE%AE)
传输控制协议（Transmission Control Protocol），面向连接的、可靠的、基于字节流的传输层通信协议。
TCP 头除了包含了目标端口号和本机端口号外，还提供了用于排序的序列号，以便接收端通过序号来重排数据包。
### 如何可靠？
- 对于数据包丢失的情况，TCP 提供重传机制；
- TCP 引入了数据包排序机制，用来保证把乱序的数据包组合成一个完整的文件。
### 生命周期
1. 建立连接阶段。这个阶段是通过“三次握手”来建立客户端和服务器之间的连接。TCP 提供面向连接的通信传输。面向连接是指在数据通信开始之前先做好两端之间的准备工作。所谓三次握手，是指在建立一个 TCP 连接时，客户端和服务器总共要发送三个数据包以确认连接的建立。
2. 传输数据阶段。接收端需要对每个数据包进行确认操作，也就是接收端在接收到数据包之后，需要发送确认数据包给发送端。所以当发送端发送了一个数据包之后，在规定时间内没有接收到接收端反馈的确认消息，则判断为数据包丢失，并触发发送端的重发机制。同样，一个大的文件在传输过程中会被拆分成很多小的数据包，这些数据包到达接收端后，接收端会按照 TCP 头中的序号为其排序，从而保证组成完整的数据。
3. 断开连接。数据传输完毕之后，就要终止连接了，涉及到最后一个阶段“四次挥手”来保证双方都能断开连接。

## HTTP
基于 TCP 的应用层协议： 先通过三次握手建立tcp链接，链接建立好之后，发送http请求行和http请求头给服务器，然后服务器返回响应行，响应头和响应体，最终完成后通过四次挥手断开tcp链接！  
可以认为，Websocket 其实是增加了服务器向客户端主动发送消息的能力的HTTP。它与socket其实不同。

### 下层为上层提供服务
TCP 为 HTTP 提供服务

